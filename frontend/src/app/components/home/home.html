<div class="container mt-3 mb-3">
    <div *ngIf="headerAd" class="w-100 text-center">
        <a [href]="headerAd.target_url || '#'" target="_blank">
            <img [src]="baseUrl + headerAd.image_path" 
                 class="img-fluid rounded shadow-sm border" 
                 [title]="headerAd.title"
                 style="max-height: 150px; width: 100%; object-fit: cover;">
        </a>
    </div>

    <div *ngIf="!headerAd" class="w-100 bg-light rounded border border-dashed d-flex align-items-center justify-content-center text-muted" style="height: 120px;">
        <span class="small fw-bold letter-spacing-1">728x90 REKLAM ALANI</span>
    </div>
</div>

<div class="breaking-news-bar bg-primary text-white overflow-hidden position-relative mb-4" style="height: 40px;">
    <div class="container-fluid h-100 p-0 d-flex"> 
        <div class="breaking-label bg-dark px-4 h-100 d-flex align-items-center fw-bold small fst-italic position-relative z-2">
            <span class="spinner-grow spinner-grow-sm text-danger me-2"></span> SON DAKİKA
        </div>
        <div class="marquee-wrapper w-100 d-flex align-items-center overflow-hidden position-relative">
            <div class="marquee-content fw-bold small">
                {{ breakingNews }}
            </div>
        </div>
    </div>
</div>

<main class="container pb-5">
    <div class="row g-5">
        
        <div class="col-lg-8">
            
            <div *ngIf="sliderNews.length > 0" 
                 class="bg-dark rounded-4 mb-5 position-relative overflow-hidden shadow-lg slider-container" 
                 style="height: 450px;"
                 (mouseenter)="stopAutoSlide()" 
                 (mouseleave)="startAutoSlide()">
                
                <a [routerLink]="['/haber', sliderNews[currentSlideIndex].slug]" class="d-block w-100 h-100 text-decoration-none cursor-pointer">
                    <img [src]="baseUrl + sliderNews[currentSlideIndex].image_path" 
                         class="w-100 h-100 object-fit-cover slider-img" 
                         alt="Manşet"
                         style="transition: opacity 0.5s ease-in-out;">
                    
                    <div class="position-absolute bottom-0 start-0 w-100 p-4" 
                         style="background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);">
                        <span class="badge bg-danger mb-2">{{ sliderNews[currentSlideIndex].category_name || 'Gündem' }}</span>
                        <h2 class="text-white fw-bold mb-1 text-shadow display-6 text-uppercase" style="font-size: 1.75rem;">
                            {{ sliderNews[currentSlideIndex].title }}
                        </h2>
                    </div>
                </a>

                <button class="btn btn-dark bg-opacity-50 position-absolute top-50 start-0 translate-middle-y ms-3 rounded-circle text-white border-0 hover-scale shadow" 
                        style="width: 45px; height: 45px; z-index: 10;"
                        (click)="prevSlide()">
                    <i class="fas fa-chevron-left"></i>
                </button>

                <button class="btn btn-dark bg-opacity-50 position-absolute top-50 end-0 translate-middle-y me-3 rounded-circle text-white border-0 hover-scale shadow" 
                        style="width: 45px; height: 45px; z-index: 10;"
                        (click)="nextSlide()">
                    <i class="fas fa-chevron-right"></i>
                </button>

                <div class="position-absolute bottom-0 start-50 translate-middle-x mb-3 d-flex gap-2" style="z-index: 10;">
                    <button *ngFor="let slide of sliderNews; let i = index" 
                            class="rounded-circle border-0 transition-all"
                            [ngClass]="i === currentSlideIndex ? 'bg-primary' : 'bg-white opacity-50'"
                            style="width: 10px; height: 10px; padding: 0;"
                            (click)="goToSlide(i)">
                    </button>
                </div>
            </div>

            <div *ngIf="sliderNews.length === 0" class="bg-secondary rounded-4 mb-5 d-flex align-items-center justify-content-center text-white" style="height: 450px;">
                <div class="text-center">
                    <i class="fas fa-images fa-3x mb-3 opacity-50"></i>
                    <p class="m-0">Henüz manşet haber girilmedi.</p>
                </div>
            </div>

            <div class="d-flex align-items-center justify-content-between mb-4 pb-2 border-bottom">
                <h3 class="mb-0 text-secondary border-start border-4 border-primary ps-3">Günün Öne Çıkanları</h3>
            </div>

            <div class="d-flex flex-column gap-4">
                <article *ngFor="let news of latestNews" class="bg-white rounded-4 shadow-sm overflow-hidden d-flex flex-column flex-md-row hover-shadow transition-all">
                    <div class="col-md-5 position-relative bg-light d-flex align-items-center justify-content-center overflow-hidden" style="min-height: 200px;">
                        <span class="badge bg-primary position-absolute top-0 start-0 m-3 z-1">{{ news.category_name || 'Gündem' }}</span>
                        
                        <img *ngIf="news.image_path" [src]="baseUrl + news.image_path" class="w-100 h-100 object-fit-cover position-absolute top-0 start-0 hover-zoom">
                        
                        <i *ngIf="!news.image_path" class="fas fa-newspaper fa-3x text-secondary opacity-25"></i>
                    </div>

                    <div class="col-md-7 p-4 d-flex flex-column justify-content-center">
                        <h4 class="fw-bold text-dark mb-2">
                            <a [routerLink]="['/haber', news.slug]" class="text-decoration-none text-dark hover-text-primary text-uppercase">
                                {{ news.title }}
                            </a>
                        </h4>
                        <p class="text-muted small mb-3 line-clamp-2" [innerHTML]="news.content | slice:0:150"></p>
                        
                        <div class="d-flex align-items-center justify-content-between mt-auto">
                            <span class="small text-muted"><i class="far fa-clock me-1"></i> {{ news.created_at | date:'dd.MM.yyyy' }}</span>
                            <a [routerLink]="['/haber', news.slug]" class="btn btn-sm btn-outline-primary rounded-pill fw-bold px-3">
                                Haberi Oku <i class="fas fa-arrow-right ms-1"></i>
                            </a>
                        </div>
                    </div>
                </article>
            </div>
<nav class="mt-4 d-flex justify-content-center" *ngIf="totalPages > 1">
  <ul class="pagination pagination-lg">

    <li class="page-item" [class.disabled]="currentPage === 1">
      <button class="page-link" (click)="loadNews(currentPage - 1)">«</button>
    </li>

    <li class="page-item" *ngIf="visiblePages[0] > 1">
      <button class="page-link" (click)="loadNews(1)">1</button>
    </li>

    <li class="page-item disabled" *ngIf="visiblePages[0] > 2">
      <span class="page-link">...</span>
    </li>

    <li class="page-item"
        *ngFor="let page of visiblePages"
        [class.active]="currentPage === page">
      <button class="page-link" (click)="loadNews(page)">{{ page }}</button>
    </li>

    <li class="page-item disabled" *ngIf="visiblePages[visiblePages.length - 1] < totalPages - 1">
      <span class="page-link">...</span>
    </li>

    <li class="page-item" *ngIf="visiblePages[visiblePages.length - 1] < totalPages">
      <button class="page-link" (click)="loadNews(totalPages)">{{ totalPages }}</button>
    </li>

    <li class="page-item" [class.disabled]="currentPage === totalPages">
      <button class="page-link" (click)="loadNews(currentPage + 1)">»</button>
    </li>

  </ul>
</nav>


        </div>

        <div class="col-lg-4">
            
            <div *ngIf="sidebarAds.length > 0" class="d-flex flex-column gap-4 mb-4">
                <div *ngFor="let ad of sidebarAds" class="bg-white border rounded-4 shadow-sm overflow-hidden text-center position-relative" style="min-height: 300px;">
                    <span class="position-absolute top-0 end-0 bg-light text-muted px-2 py-1 small" style="font-size: 0.6rem; border-bottom-left-radius: 5px;">REKLAM</span>
                    <a [href]="ad.target_url || '#'" target="_blank" class="d-block w-100 h-100">
                        <img [src]="baseUrl + ad.image_path" class="img-fluid" [title]="ad.title" style="width: 100%; height: 100%; object-fit: contain;">
                    </a>
                </div>
            </div>

            <div *ngIf="sidebarAds.length === 0" class="bg-white d-flex align-items-center justify-content-center border rounded-4 mb-4 shadow-sm" style="height: 300px; border-style: dashed !important;">
                <span class="text-secondary small fw-bold">REKLAM ALANI</span>
            </div>

            <div class="standings-container mb-4" *ngIf="standingsData.isVisible && standingsData.teams.length > 0">
  <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
    <div class="card-header bg-dark py-3 d-flex align-items-center justify-content-between">
        <h6 class="m-0 fw-bold text-white">
            <i class="fas fa-list-ol me-2 text-warning"></i> PUAN DURUMU
        </h6>
        <span class="badge bg-danger small">Süper Amatör A</span>
    </div>
    <div class="card-body p-0">
      <table class="table table-sm table-hover mb-0 custom-standings-table">
        <thead class="table-light">
          <tr class="text-center small">
            <th class="text-start ps-3 py-2">TAKIM</th>
            <th width="30">O</th>
            <th width="30">AV</th>
            <th width="35" class="bg-light fw-bold">P</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let team of standingsData.teams; let i = index" 
              [ngClass]="{'vezirkopru-highlight': team.team_name.includes('Vezirköprü')}"
              class="text-center align-middle">
            
            <td class="text-start ps-3 py-2 d-flex align-items-center">
              <span class="rank-number me-2">{{ i + 1 }}.</span>
              <img [src]="'http://localhost:3000' + team.logo_path" class="team-logo-mini me-2" *ngIf="team.logo_path">
              <span class="team-name text-truncate">{{ team.team_name }}</span>
            </td>
            
            <td>{{ team.played }}</td>
            <td>{{ team.goals_for - team.goals_against }}</td>
            <td class="fw-bold bg-light">{{ team.points }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="card-footer bg-white text-center py-2">
        <a routerLink="/puan-durumu" class="text-decoration-none small fw-bold text-primary all-details-link">
            Tüm Detaylar <i class="fas fa-chevron-right ms-1"></i>
        </a>
    </div>
  </div>
</div>

            <div class="card border-0 shadow-sm rounded-4 mb-4">
                <div class="card-header bg-primary text-white py-3 rounded-top-4">
                    <h6 class="fw-bold m-0"><i class="fas fa-poll me-2"></i> Sitemizi Nasıl Buldunuz?</h6>
                </div>
                <div class="card-body">
                    <p class="text-muted small mb-3">Görüşleriniz bizim için çok değerli. Lütfen ankete katılın.</p>
    
                    <div *ngIf="!hasVoted">
                        <div class="d-grid gap-2">
                            <button *ngFor="let poll of polls" 
                                (click)="submitVote(poll.id)" 
                                class="btn btn-outline-primary text-start fw-bold">
                                    {{ poll.option_text }}
                            </button>
                        </div>
                    </div>

                    <div *ngIf="hasVoted">
                        <div class="mb-3" *ngFor="let poll of polls">
                            <div class="d-flex justify-content-between small fw-bold mb-1">
                                <span>{{ poll.option_text }}</span>
                                <span>%{{ getPercentage(poll.vote_count) }} ({{ poll.vote_count }} Oy)</span>
                            </div>
                            <div class="progress" style="height: 10px;">
                                <div class="progress-bar bg-primary" role="progressbar" 
                                [style.width.%]="getPercentage(poll.vote_count)">
                                </div>
                            </div>
                        </div>
                        <div class="text-center mt-3 text-muted small fw-bold">
                            Toplam Oy: {{ totalVotes }}
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white p-4 rounded-4 shadow-sm border-0 mb-5 position-sticky" style="top: 100px;">
                <div class="d-flex align-items-center justify-content-between mb-4 border-bottom pb-2">
                    <h5 class="fw-bold mb-0 text-secondary border-start border-4 border-primary ps-3">Köşe Yazıları</h5>
                </div>

                <div *ngIf="columnPosts.length > 0" class="d-flex flex-column gap-3">
                    <div *ngFor="let post of columnPosts" class="d-flex align-items-start gap-3 border-bottom pb-3 last-no-border">
                        <img *ngIf="post.author_image" [src]="baseUrl + post.author_image" 
                             class="rounded-circle border border-2 border-light shadow-sm" 
                             width="50" height="50" style="object-fit: cover;">
                        
                        <div *ngIf="!post.author_image" 
                             class="rounded-circle bg-secondary text-white d-flex align-items-center justify-content-center fw-bold fs-5 shadow-sm" 
                             style="width: 50px; height: 50px;">
                             {{ post.author_name?.charAt(0) }}
                        </div>

                        <div class="flex-grow-1">
                            <h6 class="fw-bold text-dark mb-1 lh-sm">
                                <a [routerLink]="['/yazi', post.id]" class="text-decoration-none text-dark hover-text-primary">
                                    {{ post.title }}
                                </a>
                            </h6>
                            <span class="d-block small text-primary fw-bold mb-0">{{ post.author_name }}</span>
                        </div>
                    </div>
                </div>

                <div *ngIf="columnPosts.length === 0" class="text-center text-muted py-5 bg-light rounded-3 border border-light-subtle">
                    <i class="fas fa-feather-alt fa-2x mb-3 opacity-50"></i>
                    <p class="mb-0 small fw-bold">Henüz köşe yazısı girilmedi.</p>
                </div>
            </div>

            
        

        </div>

        <div class="container my-5">
            <div class="d-flex justify-content-between align-items-center border-bottom pb-2 mb-4">
                <h4 class="fw-bold text-dark m-0"><i class="fab fa-youtube text-danger me-2"></i> Video Galeri</h4>
            </div>
  
            <div class="row g-4">
                <div class="col-md-4" *ngFor="let video of videos">
                    <div class="card border-0 shadow-sm rounded-4 h-100 overflow-hidden hover-scale">
                        <iframe [src]="getSafeUrl(video.url)" height="220" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen style="width: 100%;"></iframe>
                        <div class="card-body p-3">
                            <h6 class="fw-bold text-dark m-0" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                {{ video.title }}
                            </h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</main>

<a href="https://wa.me/905369932055" class="whatsapp-float shadow-lg hover-scale" target="_blank">
    <i class="fab fa-whatsapp fa-lg"></i>
    <span class="d-none d-md-inline ms-2">İhbar Hattı</span>
</a>